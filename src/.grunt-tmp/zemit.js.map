{"version":3,"sources":["zemit.js"],"names":["Zemit","version","app","angular","module","onReadyList","onReady","args","push","config","$compileProvider","$provide","debugInfoEnabled","compileProvider","provide","run","$rs","$injector","$hook","add","forEach","callback","slice","length","params","injectors","param","get","Function","apply","isReady","directive","$zm","$session","$window","$device","$database","$i18n","$debug","restrict","link","$s","$e","attrs","load","init","getAll","session","prepare","context","setBaseScope","settings","t","$zemit","on","event","preventDefault","stopPropagation","onpageshow","onresize","isStandalone","onpagehide","onbeforeunload","$broadcast","log"],"mappings":"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","file":"zemit.js","sourcesContent":["/**\n * Zemit Application Initialization\n * @author: <contact@dannycoulombe.com>\n * Creation date: 2017-07-04\n * \n * This is where all the zemitness begins.\n */\nvar Zemit = {\n\tversion: '0.0.7'\n};\n(function() {\n\t\n\tZemit.app = angular.module('zemit', [\n\t\t'ngSanitize',\n\t\t'oc.lazyLoad'\n\t]);\n\t\n\tvar onReadyList = [];\n\tZemit.app.onReady = (args = []) => {\n\t\tonReadyList.push(args);\n\t};\n\t\n\t/**\n\t * Dynamic directive loader\n\t */\n\tZemit.app.config(function($compileProvider, $provide) {\n\t\t$compileProvider.debugInfoEnabled(false);\n\t\tZemit.app.compileProvider = $compileProvider;\n\t\tZemit.app.provide = $provide;\n\t});\n\t\n\tZemit.app.run(['$rootScope', '$injector', '$hook', function($rs, $injector, $hook) {\n\t\t\n\t\t$hook.add('onReady', () => {\n\t\t\t\n\t\t\t// Run onReady hooks\n\t\t\tonReadyList.forEach((args) => {\n\t\t\t\tlet callback = args.slice(args.length - 1, args.length)[0];\n\t\t\t\tlet params = args.slice(0, args.length - 1);\n\t\t\t\tlet injectors = [];\n\t\t\t\tparams.forEach((param) => {\n\t\t\t\t\tinjectors.push($injector.get(param));\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(callback instanceof Function) {\n\t\t\t\t\tcallback.apply(null, injectors);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t$rs.isReady = true;\n\t\t});\n\t}]);\n\t\n\tZemit.app.directive('zemit', ['$zm', '$session', '$window', '$hook', '$device', '$database', '$i18n', '$debug', function($zm, $session, $window, $hook, $device, $database, $i18n, $debug) {\n\t\treturn {\n\t\t\trestrict: 'E',\n\t\t\tlink: async function ($s, $e, attrs) {\n\t\t\t\t\n\t\t\t\tawait $session.load();\n\t\t\t\t// await $workspace.init();\n\t\t\t\tawait $i18n.init();\n\t\t\t\t\n\t\t\t\t$debug.init('core', $i18n.get('core.debugTitle'));\n\t\t\t\t\n\t\t\t\tvar session = await $session.getAll();\t\t\n\t\t\t\t$session.prepare('settings', {\n\t\t\t\t\tcontext: 'structure'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t$zm.setBaseScope($s);\n\t\t\t\t// $s.$segment = $segment;\n\t\t\t\t$s.settings = session.settings;\n\t\t\t\t$s.$device = $device;\n\t\t\t\t$s.t = $i18n.get;\n\t\t\t\t$s.$zemit = $e;\n\t\t\t\t\n\t\t\t\t// $segment.init();\n\t\t\t\t// $s.container = $segment.segment.data.content;\n\t\t\t\t// $s.widget = $s.container;\n\t\t\t\t\n\t\t\t\t// Prevent mobile contextual menu\n\t\t\t\t$e.on('contextmenu', function(event) {\n\t\t\t\t\t event.preventDefault();\n\t\t\t\t\t event.stopPropagation();\n\t\t\t\t\t return false;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// Listen to window events\n\t\t\t\t$window.onpageshow = () => $hook.run('onPageShow');\n\t\t\t\t$window.onresize = () => $hook.run('onWindowResize');\n\t\t\t\t\n\t\t\t\tif($device.isStandalone()) {\n\t\t\t\t\t$window.onpagehide = () => $hook.run('onBeforeUnload');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$window.onbeforeunload = () => $hook.run('onBeforeUnload');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$s.$zemit.on('click', function(event) {\n\t\t\t\t\t$s.$broadcast('documentClick', event);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// Whenever all modules are loaded, run onReady hooks\n\t\t\t\t$hook.add('onAllModulesRan', () => {\n\t\t\t\t\t\n\t\t\t\t\t$hook.run('onReady');\n\t\t\t\t\t\n\t\t\t\t\t$debug.log('core', 'ONREADY');\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// Allow other stuff to execute before the final state\n\t\t\t\t$hook.run('onBeforeReady');\n\t\t\t\t\n\t\t\t\t$debug.log('core', 'ONBEFOREREADY');\n\t\t\t}\n\t\t};\n\t}]);\n})();"]}