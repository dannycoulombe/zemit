{"version":3,"sources":["sidebar.js"],"names":["Zemit","app","directive","$session","$device","$timeout","$hook","$zm","$sidebar","restrict","replace","scope","templateUrl","link","$s","$e","attrs","sidebar","settings","get","prepare","tabs","global","visible","workspace","isLargeEnough","widgets","media","modules","debug","autoFocus","isPrecise","autofocus","find","length","focus","add","newContext","oldContext","showContent","list","init","updateShowContent","hideAll","getBaseScope","hidden","unhideAll","closeAll","angular","forEach","tab","key","show","hide","toggle","name","tooltip","options","direction","parent"],"mappings":";;AAAA,CAAC,YAAW;AACXA,OAAMC,GAAN,CAAUC,SAAV,CAAoB,WAApB,EAAiC,CAAC,UAAD,EAAa,SAAb,EAAwB,UAAxB,EAAoC,OAApC,EAA6C,KAA7C,EAAoD,UAApD,EAAgE,UAASC,QAAT,EAAmBC,OAAnB,EAA4BC,QAA5B,EAAsCC,KAAtC,EAA6CC,GAA7C,EAAkDC,QAAlD,EAA4D;AAC5J,SAAO;AACNC,aAAU,GADJ;AAENC,YAAS,IAFH;AAGNC,UAAO,IAHD;AAINC,gBAAa,sCAJP;AAKNC,SAAM,cAAUC,EAAV,EAAcC,EAAd,EAAkBC,KAAlB,EAAyB;;AAE9BF,OAAGN,QAAH,GAAcA,QAAd;AACAM,OAAGG,OAAH,GAAaH,EAAb;AACA;;AAEA,QAAII,WAAWf,SAASgB,GAAT,CAAa,UAAb,CAAf;AACAhB,aAASiB,OAAT,CAAiB,UAAjB,EAA6B;AAC5BH,cAAS;AACRI,YAAM;AACLC,eAAQ;AACPC,iBAAS;AADF,QADH;AAILC,kBAAW;AACVD,iBAASnB,QAAQqB,aAAR;AADC,QAJN;AAOLC,gBAAS;AACRH,iBAAS;AADD,QAPJ;AAULI,cAAO;AACNJ,iBAAS;AADH,QAVF;AAaLK,gBAAS;AACRL,iBAAS;AADD,QAbJ;AAgBLM,cAAO;AACNN,iBAAS;AADH;AAhBF;AADE;AADmB,KAA7B;;AAyBA,QAAIO,YAAY,SAAZA,SAAY,GAAW;;AAE1B,SAAG1B,QAAQ2B,SAAR,EAAH,EAAwB;AACvB1B,eAAS,YAAM;AACd,WAAI2B,YAAYjB,GAAGkB,IAAH,CAAQ,wCAAR,CAAhB;AACA,WAAGD,UAAUE,MAAV,GAAmB,CAAtB,EAAyB;AACxBF,kBAAUG,KAAV;AACA;AACD,OALD;AAMA;AACD,KAVD;;AAYA7B,UAAM8B,GAAN,CAAU,iBAAV,EAA6B,UAACC,UAAD,EAAaC,UAAb,EAA4B;AACxD,SAAGA,eAAe,SAAlB,EAA6B;AAC5BR;AACA;AACD,KAJD;;AAMAhB,OAAGO,IAAH,GAAU;;AAETkB,kBAAa,KAFJ;;AAITC,WAAM,EAJG;;AAMTC,WAAM,gBAAW;AAChB,WAAKC,iBAAL;AACA,MARQ;;AAUTC,cAAS,mBAAW;;AAEnB,UAAG,KAAKJ,WAAR,EAAqB;AACpBhC,WAAIqC,YAAJ,GAAmBL,WAAnB,GAAiC,KAAjC;AACA;;AAED,WAAKM,MAAL,GAAc,IAAd;AACA,MAjBQ;;AAmBTC,gBAAW,qBAAW;;AAErB,UAAG,KAAKP,WAAR,EAAqB;AACpBhC,WAAIqC,YAAJ,GAAmBL,WAAnB,GAAiC,IAAjC;AACA;;AAED,WAAKM,MAAL,GAAc,KAAd;AACA,MA1BQ;;AA4BTE,eAAU,oBAAW;;AAEpBC,cAAQC,OAAR,CAAgB/B,SAASD,OAAT,CAAiBI,IAAjC,EAAuC,UAAS6B,GAAT,EAAcC,GAAd,EAAmB;AACzDD,WAAI3B,OAAJ,GAAc,KAAd;AACA,OAFD;;AAIA,WAAKmB,iBAAL;AACA,MAnCQ;;AAqCTA,wBAAmB,6BAAW;;AAE7B,UAAIU,OAAO,KAAX;;AAEAJ,cAAQC,OAAR,CAAgB/B,SAASD,OAAT,CAAiBI,IAAjC,EAAuC,UAAS6B,GAAT,EAAc;AACpD,WAAGA,IAAI3B,OAAP,EAAgB;AACf6B,eAAO,IAAP;AACA;AACD,OAJD;;AAMAA,aAAO,KAAKA,IAAL,EAAP,GAAqB,KAAKC,IAAL,EAArB;;AAEA,UAAGD,IAAH,EAAS;AACR,YAAKN,SAAL;AACA;;AAED5B,eAASD,OAAT,CAAiBI,IAAjB,CAAsBC,MAAtB,CAA6BC,OAA7B,GAAuC6B,IAAvC;AACA,MAtDQ;;AAwDTA,WAAM,gBAAW;;AAEhB,WAAKb,WAAL,GAAmB,IAAnB;AACAhC,UAAIqC,YAAJ,GAAmBL,WAAnB,GAAiC,IAAjC;AACA,MA5DQ;;AA8DTc,WAAM,gBAAW;;AAEhB,WAAKd,WAAL,GAAmB,KAAnB;AACAhC,UAAIqC,YAAJ,GAAmBL,WAAnB,GAAiC,KAAjC;AACA,MAlEQ;;AAoETe,aAAQ,gBAASC,IAAT,EAAe;;AAEtBP,cAAQC,OAAR,CAAgB/B,SAASD,OAAT,CAAiBI,IAAjC,EAAuC,UAAS6B,GAAT,EAAcC,GAAd,EAAmB;AACzD,WAAGA,QAAQI,IAAX,EAAiB;AAChBL,YAAI3B,OAAJ,GAAc,KAAd;AACA;AACD,OAJD;;AAMAL,eAASD,OAAT,CAAiBI,IAAjB,CAAsBkC,IAAtB,EAA4BhC,OAA5B,GAAsC,CAACL,SAASD,OAAT,CAAiBI,IAAjB,CAAsBkC,IAAtB,EAA4BhC,OAAnE;AACA,WAAKmB,iBAAL;;AAEAZ;AACA;AAhFQ,KAAV;;AAmFAhB,OAAG0C,OAAH,GAAa;AACZC,cAAS;AACRC,iBAAW,MADH;AAERC,cAAQ;AAFA;AADG,KAAb;;AAOA7C,OAAGO,IAAH,CAAQoB,IAAR;AACA3B,OAAGG,OAAH,CAAWI,IAAX,GAAkBP,GAAGO,IAArB;AACAP,OAAGX,QAAH,GAAcA,QAAd;AACAW,OAAGI,QAAH,GAAcA,QAAd;AACA;AACA;AAtJK,GAAP;AAwJA,EAzJgC,CAAjC;AA0JA,CA3JD","file":"sidebar.js","sourcesContent":["(function() {\n\tZemit.app.directive('zmSidebar', ['$session', '$device', '$timeout', '$hook', '$zm', '$sidebar', function($session, $device, $timeout, $hook, $zm, $sidebar) {\n\t\treturn {\n\t\t\trestrict: 'E',\n\t\t\treplace: true,\n\t\t\tscope: true,\n\t\t\ttemplateUrl: 'core/directives/sidebar/sidebar.html',\n\t\t\tlink: function ($s, $e, attrs) {\n\t\t\t\t\n\t\t\t\t$s.$sidebar = $sidebar;\n\t\t\t\t$s.sidebar = $s;\n\t\t\t\t// $s.segment = $segment.segment;\n\t\t\t\t\n\t\t\t\tvar settings = $session.get('settings');\n\t\t\t\t$session.prepare('settings', {\n\t\t\t\t\tsidebar: {\n\t\t\t\t\t\ttabs: {\n\t\t\t\t\t\t\tglobal: {\n\t\t\t\t\t\t\t\tvisible: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tworkspace: {\n\t\t\t\t\t\t\t\tvisible: $device.isLargeEnough()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\twidgets: {\n\t\t\t\t\t\t\t\tvisible: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmedia: {\n\t\t\t\t\t\t\t\tvisible: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmodules: {\n\t\t\t\t\t\t\t\tvisible: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdebug: {\n\t\t\t\t\t\t\t\tvisible: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tvar autoFocus = function() {\n\t\t\t\t\t\n\t\t\t\t\tif($device.isPrecise()) {\n\t\t\t\t\t\t$timeout(() => {\n\t\t\t\t\t\t\tlet autofocus = $e.find('.zm-sidebar-tab > :visible [autofocus]');\n\t\t\t\t\t\t\tif(autofocus.length > 0) {\n\t\t\t\t\t\t\t\tautofocus.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$hook.add('onContextChange', (newContext, oldContext) => {\n\t\t\t\t\tif(oldContext === 'preview') {\n\t\t\t\t\t\tautoFocus();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t$s.tabs = {\n\t\t\t\t\t\n\t\t\t\t\tshowContent: false,\n\t\t\t\t\t\n\t\t\t\t\tlist: [],\n\t\t\t\t\t\n\t\t\t\t\tinit: function() {\n\t\t\t\t\t\tthis.updateShowContent();\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\thideAll: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.showContent) {\n\t\t\t\t\t\t\t$zm.getBaseScope().showContent = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.hidden = true;\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tunhideAll: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.showContent) {\n\t\t\t\t\t\t\t$zm.getBaseScope().showContent = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.hidden = false;\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tcloseAll: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\tangular.forEach(settings.sidebar.tabs, function(tab, key) {\n\t\t\t\t\t\t\ttab.visible = false;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.updateShowContent();\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tupdateShowContent: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar show = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tangular.forEach(settings.sidebar.tabs, function(tab) {\n\t\t\t\t\t\t\tif(tab.visible) {\n\t\t\t\t\t\t\t\tshow = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tshow ? this.show() : this.hide();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(show) {\n\t\t\t\t\t\t\tthis.unhideAll();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tsettings.sidebar.tabs.global.visible = show;\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tshow: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.showContent = true;\n\t\t\t\t\t\t$zm.getBaseScope().showContent = true;\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\thide: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.showContent = false;\n\t\t\t\t\t\t$zm.getBaseScope().showContent = false;\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\ttoggle: function(name) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tangular.forEach(settings.sidebar.tabs, function(tab, key) {\n\t\t\t\t\t\t\tif(key !== name) {\n\t\t\t\t\t\t\t\ttab.visible = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tsettings.sidebar.tabs[name].visible = !settings.sidebar.tabs[name].visible;\n\t\t\t\t\t\tthis.updateShowContent();\n\t\t\t\t\t\t\n\t\t\t\t\t\tautoFocus();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$s.tooltip = {\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tdirection: 'left',\n\t\t\t\t\t\tparent: '.zm-sidebar-tabs-inner:eq(0)'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$s.tabs.init();\n\t\t\t\t$s.sidebar.tabs = $s.tabs;\n\t\t\t\t$s.$session = $session;\n\t\t\t\t$s.settings = settings;\n\t\t\t\t// $s.$segment = $segment;\n\t\t\t}\n\t\t};\n\t}]);\n})();"]}