{"version":3,"sources":["modal.js"],"names":["Zemit","app","run","$debug","$hook","$i18n","add","init","get","directive","$timeout","$device","$modal","restrict","terminal","transclude","header","body","footer","templateUrl","link","$s","$e","attrs","id","substring","length","modal","instances","hook","$new","submit","setTimeout","find","click","on","event","which","close","$digest","visible","hidden","bodyScope","$element","log","params","onClose","Function","onRemove","onOpen","onInit","$emit","updateZIndex","zIndex","getZIndex","getSizing","$inner","height","outerHeight","width","outerWidth","pos","x","parseFloat","getAttribute","y","openFrom","$from","angular","element","fromOffset","offset","fromOuterHeight","offsetHeight","fromOuterWidth","offsetWidth","top","parseInt","left","scaledPos","copy","oriScaledPos","restraintPosition","$root","$zemit","sizing","size","maxY","window","innerHeight","maxX","innerWidth","adjustPosition","save","$container","children","removeClass","fontSize","getComputedStyle","document","documentElement","marginSize","toggleClass","css","setAttribute","open","originalParams","extend","backdrop","$backdrop","append","addClass","data","isTouch","interact","draggable","autoScroll","allowFrom","onstart","onmove","target","dx","dy","onend","styleCursor","$autofocus","focus","$btns","eq","remove","toggleVisibility"],"mappings":";;AAAA;;;;;;AAMA,CAAC,YAAW;;AAEX;;;AAGAA,OAAMC,GAAN,CAAUC,GAAV,CAAc,CAAC,QAAD,EAAW,OAAX,EAAoB,OAApB,EAA6B,UAASC,MAAT,EAAiBC,KAAjB,EAAwBC,KAAxB,EAA+B;AACzED,QAAME,GAAN,CAAU,SAAV,EAAqB;AAAA,UAAMH,OAAOI,IAAP,CAAY,OAAZ,EAAqBF,MAAMG,GAAN,CAAU,kCAAV,CAArB,CAAN;AAAA,GAArB;AACA,EAFa,CAAd;;AAIA;;;AAGAR,OAAMC,GAAN,CAAUQ,SAAV,CAAoB,SAApB,EAA+B,CAAC,OAAD,EAAU,UAAV,EAAsB,SAAtB,EAAiC,QAAjC,EAA2C,QAA3C,EAAqD,UAASL,KAAT,EAAgBM,QAAhB,EAA0BC,OAA1B,EAAmCC,MAAnC,EAA2CT,MAA3C,EAAmD;;AAEtI,SAAO;AACNU,aAAU,GADJ;AAENC,aAAU,IAFJ;AAGNC,eAAY;AACXC,YAAQ,cADG;AAEXC,UAAM,YAFK;AAGXC,YAAQ;AAHG,IAHN;AAQNC,gBAAa,kCARP;AASNC,SAAM,cAASC,EAAT,EAAaC,EAAb,EAAiBC,KAAjB,EAAwB;;AAE7B,QAAIC,KAAKD,MAAMC,EAAN,CAASC,SAAT,CAAmB,YAAYC,MAA/B,CAAT;AACA,QAAIC,QAAQf,OAAOgB,SAAP,CAAiBJ,EAAjB,CAAZ;AACA,QAAIK,OAAO,IAAIzB,MAAM0B,IAAV,EAAX;;AAEAT,OAAGT,MAAH,GAAYA,MAAZ;;AAEAS,OAAGU,MAAH,GAAY,YAAM;AACjBC,gBAAW,YAAM;AAChBV,SAAGW,IAAH,CAAQ,wDAAR,EAAkEC,KAAlE;AACA,MAFD;AAGA,KAJD;;AAMAZ,OAAGa,EAAH,CAAM,OAAN,EAAe,UAASC,KAAT,EAAgB;AAC9B,aAAOA,MAAMC,KAAb;AACC,WAAK,EAAL;AAAS;AACRhB,UAAGM,KAAH,CAASW,KAAT;AACAjB,UAAGkB,OAAH;AACA;AAJF;AAMA,KAPD;;AASA;;;AAGAlB,OAAGM,KAAH,GAAW;;AAEV;AACAH,SAAID,MAAMC,EAHA;AAIVgB,cAAS,KAJC;AAKVC,aAAQ,IALE;AAMVC,gBAAWrB,EAND;AAOVsB,eAAUrB,EAPA;;AASVf,WAAM,gBAAM;;AAEXJ,aAAOyC,GAAP,CAAW,OAAX,EAAoB,MAApB,EAA4BvB,GAAGM,KAA/B;;AAEA,UAAGN,GAAGwB,MAAH,CAAUC,OAAV,YAA6BC,QAAhC,EAA0C;AACzClB,YAAKvB,GAAL,CAAS,SAAT,EAAoB;AAAA,eAAMe,GAAGwB,MAAH,CAAUC,OAAV,CAAkBzB,GAAGM,KAArB,CAAN;AAAA,QAApB;AACA;;AAED,UAAGN,GAAGwB,MAAH,CAAUG,QAAV,YAA8BD,QAAjC,EAA2C;AAC1ClB,YAAKvB,GAAL,CAAS,UAAT,EAAqB;AAAA,eAAMe,GAAGwB,MAAH,CAAUG,QAAV,CAAmB3B,GAAGM,KAAtB,CAAN;AAAA,QAArB;AACA;;AAED,UAAGN,GAAGwB,MAAH,CAAUI,MAAV,YAA4BF,QAA/B,EAAyC;AACxClB,YAAKvB,GAAL,CAAS,QAAT,EAAmB;AAAA,eAAMe,GAAGwB,MAAH,CAAUI,MAAV,CAAiB5B,GAAGM,KAApB,CAAN;AAAA,QAAnB;AACA;;AAED,UAAGN,GAAGwB,MAAH,CAAUK,MAAV,YAA4BH,QAA/B,EAAyC;AACxC1B,UAAGwB,MAAH,CAAUK,MAAV,CAAiB7B,EAAjB;AACA;;AAEDA,SAAG8B,KAAH,CAAS,cAAc3B,EAAvB,EAA2BH,EAA3B;AACA,MA9BS;;AAgCV+B,mBAAc,wBAAW;;AAExB/B,SAAGM,KAAH,CAAS0B,MAAT,GAAkBzC,OAAO0C,SAAP,EAAlB;;AAEAnD,aAAOyC,GAAP,CAAW,OAAX,EAAoB,eAApB,EAAqCvB,GAAGM,KAAH,CAAS0B,MAA9C;AACA,MArCS;;AAuCVE,gBAAW,qBAAuB;AAAA,UAAdhD,IAAc,uEAAP,KAAO;;;AAEjC,UAAIiD,SAASlC,GAAGW,IAAH,CAAQ,uBAAR,CAAb;AACA,UAAIY,SAASxB,GAAGM,KAAH,CAASkB,MAAtB;AACA,UAAIY,SAASD,OAAOE,WAAP,CAAmB,IAAnB,CAAb;AACA,UAAIC,QAAQH,OAAOI,UAAP,CAAkB,IAAlB,CAAZ;AACA,UAAIC,MAAM;AACTC,UAAIC,WAAWP,OAAO,CAAP,EAAUQ,YAAV,CAAuB,QAAvB,CAAX,KAAgD,CAD3C;AAETC,UAAIF,WAAWP,OAAO,CAAP,EAAUQ,YAAV,CAAuB,QAAvB,CAAX,KAAgD;AAF3C,OAAV;;AAKA,UAAGzD,QAAQsC,OAAOqB,QAAlB,EAA4B;;AAE3B,WAAIC,QAAQC,QAAQC,OAAR,CAAgBxB,OAAOqB,QAAvB,CAAZ;AACA,WAAII,aAAaH,MAAMI,MAAN,EAAjB;;AAEA,WAAIC,kBAAkBL,MAAM,CAAN,EAASM,YAA/B;AACA,WAAIC,iBAAiBP,MAAM,CAAN,EAASQ,WAA9B;;AAEAd,WAAII,CAAJ,GAASK,WAAWM,GAAX,GAAkBJ,kBAAkB,CAArC,GAA2CK,SAASpB,SAAS,CAAlB,CAAnD;AACAI,WAAIC,CAAJ,GAASQ,WAAWQ,IAAX,GAAmBJ,iBAAiB,CAArC,GAA2CG,SAASlB,QAAQ,CAAjB,CAAnD;;AAEA,WAAIoB,YAAYX,QAAQY,IAAR,CAAanB,GAAb,CAAhB;AACA;AACA;;AAEA,WAAIoB,eAAeb,QAAQY,IAAR,CAAaD,SAAb,CAAnB;AACA,YAAKG,iBAAL,CAAuBH,SAAvB,EAAkC;AACjCtB,gBAAQD,OAAO,CAAP,EAAUiB,YADe;AAEjCd,eAAOH,OAAO,CAAP,EAAUmB;AAFgB,QAAlC;;AAKAd,WAAII,CAAJ,GAAQc,UAAUd,CAAV,KAAgBgB,aAAahB,CAA7B,GAAiCc,UAAUd,CAA3C,GAA+CJ,IAAII,CAA3D;AACAJ,WAAIC,CAAJ,GAAQiB,UAAUjB,CAAV,KAAgBmB,aAAanB,CAA7B,GAAiCiB,UAAUjB,CAA3C,GAA+CD,IAAIC,CAA3D;AACA,OAvBD,MAwBK,IAAGvD,IAAH,EAAS;;AAEbsD,WAAII,CAAJ,GAAS5C,GAAG8D,KAAH,CAASC,MAAT,CAAgB1B,WAAhB,KAAgC,CAAjC,GAAsCmB,SAASpB,SAAS,CAAlB,CAA9C;AACAI,WAAIC,CAAJ,GAASzC,GAAG8D,KAAH,CAASC,MAAT,CAAgBxB,UAAhB,KAA+B,CAAhC,GAAqCiB,SAASlB,QAAQ,CAAjB,CAA7C;AACA;;AAED,UAAI0B,SAAS;AACZxB,YAAKA,GADO;AAEZyB,aAAM;AACL7B,gBAAQA,MADH;AAELE,eAAOA;AAFF;AAFM,OAAb;;AAQAxD,aAAOyC,GAAP,CAAW,OAAX,EAAoB,YAApB,EAAkCyC,MAAlC;;AAEA,aAAOA,MAAP;AACA,MA3FS;;AA6FVH,wBAAmB,2BAASrB,GAAT,EAAcyB,IAAd,EAAoB;;AAEtC,UAAIC,OAAOC,OAAOC,WAAP,GAAqBH,KAAK7B,MAArC;AACA,UAAIiC,OAAOF,OAAOG,UAAP,GAAoBL,KAAK3B,KAApC;AACAE,UAAII,CAAJ,GAAQJ,IAAII,CAAJ,GAAQsB,IAAR,GAAeA,IAAf,GAAsB1B,IAAII,CAAJ,GAAQ,CAAR,GAAY,CAAZ,GAAgBJ,IAAII,CAAlD;AACAJ,UAAIC,CAAJ,GAAQD,IAAIC,CAAJ,GAAQ4B,IAAR,GAAeA,IAAf,GAAsB7B,IAAIC,CAAJ,GAAQ,CAAR,GAAY,CAAZ,GAAgBD,IAAIC,CAAlD;;AAEA3D,aAAOyC,GAAP,CAAW,OAAX,EAAoB,oBAApB,EAA0CiB,GAA1C;AACA,MArGS;;AAuGV+B,qBAAgB,0BAAoC;AAAA,UAA3BrF,IAA2B,uEAApB,KAAoB;AAAA,UAAbsF,IAAa,uEAAN,IAAM;;;AAEnD,UAAIC,aAAaxE,GAAGyE,QAAH,EAAjB;AACAD,iBAAWE,WAAX,CAAuB,qCAAvB;;AAEA,UAAInD,SAASxB,GAAGM,KAAH,CAASkB,MAAtB;AACA,UAAIW,SAASlC,GAAGW,IAAH,CAAQ,uBAAR,CAAb;AACA,UAAIoD,SAAS,KAAK9B,SAAL,CAAehD,IAAf,CAAb;;AAEA,UAAI0F,WAAWlC,WAAWmC,iBAAiBC,SAASC,eAA1B,EAA2CH,QAAtD,CAAf;AACA,UAAII,aAAc,IAAIJ,QAAtB;;AAEAH,iBAAWQ,WAAX,CAAuB,mBAAvB,EAA4CjB,OAAOC,IAAP,CAAY3B,KAAZ,GAAoB0C,UAApB,GAAiCb,OAAOG,UAApF;AACAG,iBAAWQ,WAAX,CAAuB,mBAAvB,EAA4CjB,OAAOC,IAAP,CAAY7B,MAAZ,GAAqB4C,UAArB,GAAkCb,OAAOC,WAArF;AACA,UAAIJ,SAAS,KAAK9B,SAAL,CAAehD,IAAf,CAAb;;AAEA,WAAK2E,iBAAL,CAAuBG,OAAOxB,GAA9B,EAAmCwB,OAAOC,IAA1C;;AAEA9B,aAAO+C,GAAP,CAAW,KAAX,EAAkB,EAAlB;AACA/C,aAAO+C,GAAP,CAAW,MAAX,EAAmB,EAAnB;;AAEA;AACA/C,aAAO+C,GAAP,CAAW,EAAC,OAAOlB,OAAOxB,GAAP,CAAWI,CAAX,GAAe,IAAvB,EAAX;AACAT,aAAO+C,GAAP,CAAW,EAAC,QAAQlB,OAAOxB,GAAP,CAAWC,CAAX,GAAe,IAAxB,EAAX;;AAEA;AACA,UAAG+B,IAAH,EAAS;AACRrC,cAAO,CAAP,EAAUgD,YAAV,CAAuB,QAAvB,EAAiCnB,OAAOxB,GAAP,CAAWC,CAA5C;AACAN,cAAO,CAAP,EAAUgD,YAAV,CAAuB,QAAvB,EAAiCnB,OAAOxB,GAAP,CAAWI,CAA5C;AACA;;AAED9D,aAAOyC,GAAP,CAAW,OAAX,EAAoB,YAApB,EAAkCyC,OAAOxB,GAAzC;AACA,MAvIS;;AAyIV;;;AAGA4C,WAAM,gBAAsB;AAAA,UAAb5D,MAAa,uEAAJ,EAAI;;;AAE3B1C,aAAOyC,GAAP,CAAW,OAAX,EAAoB,MAApB,EAA4BC,MAA5B;;AAEA,UAAGxB,GAAGM,KAAH,CAASa,OAAZ,EAAqB;AACpBnB,UAAGM,KAAH,CAAS0B,MAAT,GAAkBzC,OAAO0C,SAAP,EAAlB;AACA;AACA;;AAED,UAAI9B,KAAKH,GAAGM,KAAH,CAASH,EAAT,CAAYC,SAAZ,CAAsB,YAAYC,MAAlC,CAAT;AACA,UAAIgF,iBAAiB/E,MAAMkB,MAA3B;AACAA,eAASuB,QAAQuC,MAAR,CAAeD,cAAf,EAA+B7D,MAA/B,CAAT;;AAEAxB,SAAGM,KAAH,CAAS0B,MAAT,GAAkBzC,OAAO0C,SAAP,EAAlB;AACAjC,SAAGM,KAAH,CAASa,OAAT,GAAmB,IAAnB;AACAnB,SAAGM,KAAH,CAASc,MAAT,GAAkB,KAAlB;AACApB,SAAGM,KAAH,CAASiF,QAAT,GAAoB/D,OAAO+D,QAAP,IAAmB,KAAvC;AACAvF,SAAGM,KAAH,CAASkB,MAAT,GAAkBA,MAAlB;;AAEA,UAAIgE,SAAJ;AACA,UAAGxF,GAAGM,KAAH,CAASiF,QAAZ,EAAsB;AACrBvF,UAAGM,KAAH,CAASkF,SAAT,GAAqBzC,QAAQC,OAAR,CAAgB,qDAAqDhD,GAAGM,KAAH,CAAS0B,MAAT,GAAkB,CAAvE,IAA4E,UAA5F,CAArB;AACAe,eAAQC,OAAR,CAAgBhD,GAAG8D,KAAH,CAASC,MAAzB,EAAiC0B,MAAjC,CAAwCzF,GAAGM,KAAH,CAASkF,SAAjD;AACA7E,kBAAW;AAAA,eAAMX,GAAGM,KAAH,CAASkF,SAAT,CAAmBE,QAAnB,CAA4B,WAA5B,CAAN;AAAA,QAAX;AACA;;AAED,WAAKnB,cAAL,CAAoB,IAApB;;AAEA;AACA,WAAKoB,IAAL,GAAYnE,OAAOmE,IAAP,IAAe,EAA3B;;AAEA;AACA,UAAG,CAACrG,QAAQsG,OAAR,EAAJ,EAAuB;;AAEtB,WAAIzD,SAASlC,GAAGW,IAAH,CAAQ,uBAAR,CAAb;;AAEAiF,gBAAS1D,OAAO,CAAP,CAAT,EAAoB2D,SAApB,CAA8B;AAC7BC,oBAAY,KADiB;AAE7BC,mBAAW,kBAFkB;AAG7BC,iBAAS,iBAASlF,KAAT,EAAgB;AACxBjC,gBAAOyC,GAAP,CAAW,OAAX,EAAoB,YAApB,EAAkCR,KAAlC;AACA,SAL4B;AAM7BmF,gBAAQ,gBAASnF,KAAT,EAAgB;;AAEvBjC,gBAAOyC,GAAP,CAAW,OAAX,EAAoB,MAApB,EAA4BR,KAA5B;;AAEA,aAAIoF,SAASpF,MAAMoF,MAAnB;;AACC;AACA1D,aAAI,CAACC,WAAWP,OAAO,CAAP,EAAUQ,YAAV,CAAuB,QAAvB,CAAX,KAAgD,CAAjD,IAAsD5B,MAAMqF,EAFjE;AAAA,aAGCxD,IAAI,CAACF,WAAWP,OAAO,CAAP,EAAUQ,YAAV,CAAuB,QAAvB,CAAX,KAAgD,CAAjD,IAAsD5B,MAAMsF,EAHjE;;AAKA;AACAlE,gBAAO+C,GAAP,CAAW,KAAX,EAAkBtC,IAAI,IAAtB;AACAT,gBAAO+C,GAAP,CAAW,MAAX,EAAmBzC,IAAI,IAAvB;AACAN,gBAAO,CAAP,EAAUgD,YAAV,CAAuB,QAAvB,EAAiC1C,CAAjC;AACAN,gBAAO,CAAP,EAAUgD,YAAV,CAAuB,QAAvB,EAAiCvC,CAAjC;AACA,SApB4B;AAqB7B0D,eAAO,eAASvF,KAAT,EAAgB;;AAEtBjC,gBAAOyC,GAAP,CAAW,OAAX,EAAoB,UAApB,EAAgCR,KAAhC;;AAEA,aAAIyB,MAAM;AACTI,aAAGF,WAAWP,OAAO+C,GAAP,CAAW,KAAX,CAAX,CADM;AAETzC,aAAGC,WAAWP,OAAO+C,GAAP,CAAW,MAAX,CAAX;AAFM,UAAV;;AAKA;AACAlF,YAAGM,KAAH,CAASuD,iBAAT,CAA2BrB,GAA3B,EAAgC;AAC/BJ,kBAAQD,OAAOE,WAAP,CAAmB,IAAnB,CADuB;AAE/BC,iBAAOH,OAAOI,UAAP,CAAkB,IAAlB;AAFwB,UAAhC;AAIAJ,gBAAO+C,GAAP,CAAW,KAAX,EAAkB1C,IAAII,CAAJ,GAAQ,IAA1B;AACAT,gBAAO+C,GAAP,CAAW,MAAX,EAAmB1C,IAAIC,CAAJ,GAAQ,IAA3B;AACAN,gBAAO,CAAP,EAAUgD,YAAV,CAAuB,QAAvB,EAAiC3C,IAAIC,CAArC;AACAN,gBAAO,CAAP,EAAUgD,YAAV,CAAuB,QAAvB,EAAiC3C,IAAII,CAArC;AACA;AAvC4B,QAA9B,EAwCG2D,WAxCH,CAwCe,KAxCf;AAyCA;;AAED,UAAG/E,OAAOI,MAAP,YAAyBF,QAA5B,EAAsC;AACrCF,cAAOI,MAAP,CAAc5B,GAAGM,KAAjB;AACA;;AAEDE,WAAK3B,GAAL,CAAS,QAAT,EAAmBmB,EAAnB;;AAEA,UAAIwG,aAAavG,GAAGW,IAAH,CAAQ,aAAR,CAAjB;AACA,UAAG4F,WAAWnG,MAAX,GAAoB,CAAvB,EAA0B;AACzBM,kBAAW,YAAW;AACrB6F,mBAAWC,KAAX;AACA,QAFD,EAEG,GAFH;AAGA,OAJD,MAKK;;AAEJ9F,kBAAW,YAAW;AACrB,YAAI+F,QAAQzG,GAAGW,IAAH,CAAQ,iCAAR,CAAZ;AACA,YAAG8F,MAAMrG,MAAN,KAAiB,CAApB,EAAuB;AACtBqG,eAAMC,EAAN,CAAS,CAAT,EAAYF,KAAZ;AACA;AACD,QALD,EAKG,GALH;AAMA;AACD,MAhPS;;AAkPV;;;AAGAxF,YAAO,iBAAW;;AAEjBnC,aAAOyC,GAAP,CAAW,OAAX,EAAoB,OAApB,EAA6BvB,GAAGM,KAAhC;;AAEAN,SAAGM,KAAH,CAASa,OAAT,GAAmB,KAAnB;AACAnB,SAAGM,KAAH,CAASiF,QAAT,GAAoB,KAApB;;AAEA,UAAGvF,GAAGM,KAAH,CAASkF,SAAZ,EAAuB;AACtBxF,UAAGM,KAAH,CAASkF,SAAT,CAAmBb,WAAnB,CAA+B,WAA/B;AACAhE,kBAAW;AAAA,eAAMX,GAAGM,KAAH,CAASkF,SAAT,CAAmBoB,MAAnB,EAAN;AAAA,QAAX,EAA8C,GAA9C;AACA;;AAEDvH,eAAS,YAAW;AACnBW,UAAGM,KAAH,CAASc,MAAT,GAAkB,IAAlB;AACA,OAFD,EAEG,GAFH;;AAIAZ,WAAK3B,GAAL,CAAS,SAAT,EAAoB,IAApB;AACA,MAtQS;;AAwQV+H,aAAQ,kBAAW;;AAElB9H,aAAOyC,GAAP,CAAW,OAAX,EAAoB,QAApB,EAA8BvB,GAAGM,KAAjC;;AAEAL,SAAG2G,MAAH;;AAEA,aAAOrH,OAAOgB,SAAP,CAAiBJ,EAAjB,CAAP;;AAEAK,WAAK3B,GAAL,CAAS,UAAT,EAAqB,IAArB;AACA,MAjRS;;AAmRV;;;AAGAgI,uBAAkB,4BAAW;;AAE5B/H,aAAOyC,GAAP,CAAW,OAAX,EAAoB,mBAApB,EAAyCvB,GAAGM,KAA5C;;AAEAN,SAAGM,KAAH,CAASa,OAAT,GAAmB,CAACnB,GAAGM,KAAH,CAASa,OAA7B;AACA;AA3RS,KAAX;;AA8RAnB,OAAGM,KAAH,CAASpB,IAAT;AACA;AAlUK,GAAP;AAoUA,EAtU8B,CAA/B;AAuUA,CAnVD","file":"modal.js","sourcesContent":["/**\n * Modal: With this directive, you can instantiate modals containing anything\n * you need.\n * \n * @author <contact@dannycoulombe.com>\n */\n(function() {\n\t\n\t/**\n\t * Modal initialization\n\t */\n\tZemit.app.run(['$debug', '$hook', '$i18n', function($debug, $hook, $i18n) {\n\t\t$hook.add('onReady', () => $debug.init('modal', $i18n.get('core.directives.modal.debugTitle')));\n\t}]);\n\t\n\t/**\n\t * Modal directive\n\t */\n\tZemit.app.directive('zmModal', ['$hook', '$timeout', '$device', '$modal', '$debug', function($hook, $timeout, $device, $modal, $debug) {\n\n\t\treturn {\n\t\t\trestrict: 'E',\n\t\t\tterminal: true,\n\t\t\ttransclude: {\n\t\t\t\theader: '?modalHeader',\n\t\t\t\tbody: '?modalBody',\n\t\t\t\tfooter: '?modalFooter',\n\t\t\t},\n\t\t\ttemplateUrl: 'core/directives/modal/modal.html',\n\t\t\tlink: function($s, $e, attrs) {\n\t\t\t\t\n\t\t\t\tvar id = attrs.id.substring('zm_modal_'.length);\n\t\t\t\tvar modal = $modal.instances[id];\n\t\t\t\tvar hook = new $hook.$new();\n\t\t\t\t\n\t\t\t\t$s.$modal = $modal;\n\t\t\t\t\n\t\t\t\t$s.submit = () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t$e.find('.zm-modal-footer-inner .zm-btn-primary:not([disabled])').click();\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$e.on('keyup', function(event) {\n\t\t\t\t\tswitch(event.which) {\n\t\t\t\t\t\tcase 27: // ESC\n\t\t\t\t\t\t\t$s.modal.close();\n\t\t\t\t\t\t\t$s.$digest();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t/**\n\t\t\t\t * Modal functionalities\n\t\t\t\t */\n\t\t\t\t$s.modal = {\n\t\t\t\t\t\n\t\t\t\t\t// Set default values\n\t\t\t\t\tid: attrs.id,\n\t\t\t\t\tvisible: false,\n\t\t\t\t\thidden: true,\n\t\t\t\t\tbodyScope: $s,\n\t\t\t\t\t$element: $e,\n\t\t\t\t\t\n\t\t\t\t\tinit: () => {\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'INIT', $s.modal);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($s.params.onClose instanceof Function) {\n\t\t\t\t\t\t\thook.add('onClose', () => $s.params.onClose($s.modal));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($s.params.onRemove instanceof Function) {\n\t\t\t\t\t\t\thook.add('onRemove', () => $s.params.onRemove($s.modal));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($s.params.onOpen instanceof Function) {\n\t\t\t\t\t\t\thook.add('onOpen', () => $s.params.onOpen($s.modal));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($s.params.onInit instanceof Function) {\n\t\t\t\t\t\t\t$s.params.onInit($s);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t$s.$emit('initModal' + id, $s);\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tupdateZIndex: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\t$s.modal.zIndex = $modal.getZIndex();\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'UPDATE_ZINDEX', $s.modal.zIndex);\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tgetSizing: function(init = false) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar $inner = $e.find('.zm-modal-inner:eq(0)');\n\t\t\t\t\t\tvar params = $s.modal.params;\n\t\t\t\t\t\tvar height = $inner.outerHeight(true);\n\t\t\t\t\t\tvar width = $inner.outerWidth(true);\n\t\t\t\t\t\tvar pos = {\n\t\t\t\t\t\t\tx: (parseFloat($inner[0].getAttribute('data-x')) || 0),\n\t\t\t\t\t\t\ty: (parseFloat($inner[0].getAttribute('data-y')) || 0)\n\t\t\t\t\t\t};\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(init && params.openFrom) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar $from = angular.element(params.openFrom);\n\t\t\t\t\t\t\tvar fromOffset = $from.offset();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar fromOuterHeight = $from[0].offsetHeight;\n\t\t\t\t\t\t\tvar fromOuterWidth = $from[0].offsetWidth;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tpos.y = (fromOffset.top + (fromOuterHeight / 2)) - parseInt(height / 2);\n\t\t\t\t\t\t\tpos.x = (fromOffset.left + (fromOuterWidth / 2)) - parseInt(width / 2);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar scaledPos = angular.copy(pos);\n\t\t\t\t\t\t\t//scaledPos.y /= 1.075;\n\t\t\t\t\t\t\t//scaledPos.x /= 1.075;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar oriScaledPos = angular.copy(scaledPos);\n\t\t\t\t\t\t\tthis.restraintPosition(scaledPos, {\n\t\t\t\t\t\t\t\theight: $inner[0].offsetHeight,\n\t\t\t\t\t\t\t\twidth: $inner[0].offsetWidth\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tpos.y = scaledPos.y !== oriScaledPos.y ? scaledPos.y : pos.y;\n\t\t\t\t\t\t\tpos.x = scaledPos.x !== oriScaledPos.x ? scaledPos.x : pos.x;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(init) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tpos.y = ($s.$root.$zemit.outerHeight() / 2) - parseInt(height / 2);\n\t\t\t\t\t\t\tpos.x = ($s.$root.$zemit.outerWidth() / 2) - parseInt(width / 2);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet sizing = {\n\t\t\t\t\t\t\tpos: pos,\n\t\t\t\t\t\t\tsize: {\n\t\t\t\t\t\t\t\theight: height,\n\t\t\t\t\t\t\t\twidth: width\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'GET_SIZING', sizing);\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn sizing;\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\trestraintPosition: function(pos, size) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar maxY = window.innerHeight - size.height;\n\t\t\t\t\t\tvar maxX = window.innerWidth - size.width;\n\t\t\t\t\t\tpos.y = pos.y > maxY ? maxY : pos.y < 0 ? 0 : pos.y;\n\t\t\t\t\t\tpos.x = pos.x > maxX ? maxX : pos.x < 0 ? 0 : pos.x;\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'RESTRAINT_POSITION', pos);\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tadjustPosition: function(init = false, save = true) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet $container = $e.children();\n\t\t\t\t\t\t$container.removeClass('zm-modal-exceed-x zm-modal-exceed-y');\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar params = $s.modal.params;\n\t\t\t\t\t\tvar $inner = $e.find('.zm-modal-inner:eq(0)');\n\t\t\t\t\t\tvar sizing = this.getSizing(init);\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet fontSize = parseFloat(getComputedStyle(document.documentElement).fontSize);\n\t\t\t\t\t\tlet marginSize = (1 * fontSize);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t$container.toggleClass('zm-modal-exceed-x', sizing.size.width - marginSize > window.innerWidth);\n\t\t\t\t\t\t$container.toggleClass('zm-modal-exceed-y', sizing.size.height - marginSize > window.innerHeight);\n\t\t\t\t\t\tvar sizing = this.getSizing(init);\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.restraintPosition(sizing.pos, sizing.size);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$inner.css('top', '');\n\t\t\t\t\t\t$inner.css('left', '');\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Set modal position\n\t\t\t\t\t\t$inner.css({'top': sizing.pos.y + 'px'});\n\t\t\t\t\t\t$inner.css({'left': sizing.pos.x + 'px'});\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Reset previous position\n\t\t\t\t\t\tif(save) {\n\t\t\t\t\t\t\t$inner[0].setAttribute('data-x', sizing.pos.x);\n\t\t\t\t\t\t\t$inner[0].setAttribute('data-y', sizing.pos.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'ADJUST_POS', sizing.pos);\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\t/**\n\t\t\t\t\t * Open the modal\n\t\t\t\t\t */\n\t\t\t\t\topen: function(params = {}) {\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'OPEN', params);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($s.modal.visible) {\n\t\t\t\t\t\t\t$s.modal.zIndex = $modal.getZIndex();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar id = $s.modal.id.substring('zm_modal_'.length);\n\t\t\t\t\t\tvar originalParams = modal.params;\n\t\t\t\t\t\tparams = angular.extend(originalParams, params);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$s.modal.zIndex = $modal.getZIndex();\n\t\t\t\t\t\t$s.modal.visible = true;\n\t\t\t\t\t\t$s.modal.hidden = false;\n\t\t\t\t\t\t$s.modal.backdrop = params.backdrop || false;\n\t\t\t\t\t\t$s.modal.params = params;\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar $backdrop;\n\t\t\t\t\t\tif($s.modal.backdrop) {\n\t\t\t\t\t\t\t$s.modal.$backdrop = angular.element('<div class=\"zm-modal-backdrop\" style=\"z-index: ' + ($s.modal.zIndex - 1) + '\"></div>');\n\t\t\t\t\t\t\tangular.element($s.$root.$zemit).append($s.modal.$backdrop);\n\t\t\t\t\t\t\tsetTimeout(() => $s.modal.$backdrop.addClass('zm-loaded'));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.adjustPosition(true);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Set data\n\t\t\t\t\t\tthis.data = params.data || {};\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Make modal draggable\n\t\t\t\t\t\tif(!$device.isTouch()) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar $inner = $e.find('.zm-modal-inner:eq(0)');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tinteract($inner[0]).draggable({\n\t\t\t\t\t\t\t\tautoScroll: false,\n\t\t\t\t\t\t\t\tallowFrom: '.zm-modal-header',\n\t\t\t\t\t\t\t\tonstart: function(event) {\n\t\t\t\t\t\t\t\t\t$debug.log('modal', 'MOVE_START', event);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonmove: function(event) {\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t$debug.log('modal', 'MOVE', event);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tvar target = event.target,\n\t\t\t\t\t\t\t\t\t\t// keep the dragged position in the data-x/data-y attributes\n\t\t\t\t\t\t\t\t\t\tx = (parseFloat($inner[0].getAttribute('data-x')) || 0) + event.dx,\n\t\t\t\t\t\t\t\t\t\ty = (parseFloat($inner[0].getAttribute('data-y')) || 0) + event.dy;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// update the posiion attributes\n\t\t\t\t\t\t\t\t\t$inner.css('top', y + 'px');\n\t\t\t\t\t\t\t\t\t$inner.css('left', x + 'px');\n\t\t\t\t\t\t\t\t\t$inner[0].setAttribute('data-x', x);\n\t\t\t\t\t\t\t\t\t$inner[0].setAttribute('data-y', y);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonend: function(event) {\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t$debug.log('modal', 'MOVE_END', event);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tvar pos = {\n\t\t\t\t\t\t\t\t\t\ty: parseFloat($inner.css('top')),\n\t\t\t\t\t\t\t\t\t\tx: parseFloat($inner.css('left'))\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// Make sure the modal is within the restricted area\n\t\t\t\t\t\t\t\t\t$s.modal.restraintPosition(pos, {\n\t\t\t\t\t\t\t\t\t\theight: $inner.outerHeight(true),\n\t\t\t\t\t\t\t\t\t\twidth: $inner.outerWidth(true)\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t$inner.css('top', pos.y + 'px');\n\t\t\t\t\t\t\t\t\t$inner.css('left', pos.x + 'px');\n\t\t\t\t\t\t\t\t\t$inner[0].setAttribute('data-x', pos.x);\n\t\t\t\t\t\t\t\t\t$inner[0].setAttribute('data-y', pos.y);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).styleCursor(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(params.onOpen instanceof Function) {\n\t\t\t\t\t\t\tparams.onOpen($s.modal);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\thook.run('onOpen', $s);\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar $autofocus = $e.find('[autofocus]');\n\t\t\t\t\t\tif($autofocus.length > 0) {\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t$autofocus.focus();\n\t\t\t\t\t\t\t}, 250);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tvar $btns = $e.find('.zm-btn-default:not([disabled])');\n\t\t\t\t\t\t\t\tif($btns.length === 1) {\n\t\t\t\t\t\t\t\t\t$btns.eq(0).focus();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\t/**\n\t\t\t\t\t * Close the modal\n\t\t\t\t\t */\n\t\t\t\t\tclose: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'CLOSE', $s.modal);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$s.modal.visible = false;\n\t\t\t\t\t\t$s.modal.backdrop = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($s.modal.$backdrop) {\n\t\t\t\t\t\t\t$s.modal.$backdrop.removeClass('zm-loaded');\n\t\t\t\t\t\t\tsetTimeout(() => $s.modal.$backdrop.remove(), 250);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\t\t$s.modal.hidden = true;\n\t\t\t\t\t\t}, 250);\n\t\t\t\t\t\t\n\t\t\t\t\t\thook.run('onClose', this);\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tremove: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'REMOVE', $s.modal);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$e.remove();\n\t\t\t\t\t\t\n\t\t\t\t\t\tdelete $modal.instances[id];\n\t\t\t\t\t\t\n\t\t\t\t\t\thook.run('onRemove', this);\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\t/**\n\t\t\t\t\t * Toggle modal visibility\n\t\t\t\t\t */\n\t\t\t\t\ttoggleVisibility: function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\t$debug.log('modal', 'TOGGLE_VISIBILITY', $s.modal);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$s.modal.visible = !$s.modal.visible;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$s.modal.init();\n\t\t\t}\n\t\t};\n\t}]);\n})();\t"]}