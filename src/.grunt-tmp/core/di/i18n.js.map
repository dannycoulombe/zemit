{"version":3,"sources":["i18n.js"],"names":["Zemit","app","factory","$q","$http","$util","$device","data","language","init","Promise","resolve","reject","lang","navigator","substring","setLang","Object","keys","load","literals","angular","merge","get","key","params","dig","cat","console","warn","splice","length","split","label","paramKeys","forEach","replace","langParam","getUrlParam","getBestLang"],"mappings":"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","file":"i18n.js","sourcesContent":["/**\n * Zemit Internationalization\n * @author: <contact@dannycoulombe.com>\n * \n * Print and update app's language.\n */\n(function() {\n\tZemit.app.factory('$i18n', ['$q', '$http', '$util', '$device', function($q, $http, $util, $device) {\n\t\t\n\t\tvar factory = {\n\t\t\t\n\t\t\tdata: {\n\t\t\t\t'en_CA': {},\n\t\t\t\t'fr_CA': {}\n\t\t\t},\n\t\t\t\n\t\t\tlanguage: 'en_CA',\n\t\t\t\n\t\t\tinit: function() {\n\t\t\t\t\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t\n\t\t\t\t\tlet lang = navigator.language.substring(0, 5);\n\t\t\t\t\n\t\t\t\t\tif(this.data[lang]) {\n\t\t\t\t\t\tthis.language = lang;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tlang = this.language;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\tsetLang: function(lang) {\n\t\t\t\t\n\t\t\t\tif(!this.data[lang]) {\n\t\t\t\t\tlang = Object.keys(this.data)[0];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.language = lang;\n\t\t\t},\n\t\t\t\n\t\t\tload: function(lang, data = {}) {\n\t\t\t\t\n\t\t\t\tvar literals = {};\n\t\t\t\tliterals[lang] = data;\n\t\t\t\tangular.merge(this.data, literals);\n\t\t\t},\n\t\t\t\n\t\t\tget: function(key, params = {}, lang = factory.language) {\n\t\t\t\t\n\t\t\t\tif(!factory.data[lang]) {\n\t\t\t\t\treturn key;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlet dig = function(cat, keys, key) {\n\t\t\t\t\t\n\t\t\t\t\tif(!cat[keys[0]]) {\n\t\t\t\t\t\tconsole.warn('LABEL_NOT_FOUND', key);\n\t\t\t\t\t\treturn key;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tcat = cat[keys[0]];\n\t\t\t\t\tkeys.splice(0, 1);\n\t\t\t\t\t\n\t\t\t\t\tif(keys.length > 0) {\n\t\t\t\t\t\treturn dig(cat, keys, key);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn cat;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tlet cat = factory.data[lang];\n\t\t\t\tlet keys = key.split('.');\n\t\t\t\tlet label = dig(cat, keys, key);\n\t\t\t\t\n\t\t\t\t// Apply params to label\n\t\t\t\tlet paramKeys = Object.keys(params);\n\t\t\t\tparamKeys.forEach((key) => {\n\t\t\t\t\tlabel = label.replace(':' + key + ':', params[key]);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn label;\n\t\t\t}\n\t\t};\n\t\t\n\t\tlet langParam = $util.getUrlParam('lang');\n\t\tif(langParam) {\n\t\t\tfactory.setLang(langParam);\n\t\t}\n\t\telse {\n\t\t\tfactory.setLang($device.getBestLang());\n\t\t}\n\t\t\n\t\treturn factory;\n\t}]);\n})();"]}